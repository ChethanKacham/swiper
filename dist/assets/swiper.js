import{r,h as u,j as n,S as w,N as f,P as p,a as S,c as m}from"./index.js";import{s as l,E as x}from"./effect-coverflow.js";function g({images:i}){const[c,o]=r.useState(0),a=r.useRef(null);r.useEffect(()=>{(()=>{const s=new URLSearchParams(window.location.hash.substring(1)),t=s.get("feed"),h=parseInt(s.get("scene"),10);console.log(`Initial hash params - feed: ${t}, scene: ${h}`),window.history.replaceState(null,null,"#feed=nasa&scene=1"),o(1)})()},[]),r.useEffect(()=>{const e=()=>{const s=new URLSearchParams(window.location.hash.substring(1)),t=parseInt(s.get("scene"),10);!isNaN(t)&&t>0&&t<11&&a.current?a.current.swiper.slideToLoop(t-1):a.current.swiper.slideToLoop(0)};return window.addEventListener("hashchange",e),()=>window.removeEventListener("hashchange",e)},[]);const d=e=>{const s=e.realIndex+1;o(s),window.history.replaceState(null,null,`#feed=nasa&scene=${s}`)};return r.useEffect(()=>{console.log(`activeIndex updated: ${c}`)},[c]),r.useEffect(()=>{u()},[i]),n.jsx("div",{className:l.swiperContainer,children:n.jsx(w,{effect:"coverflow",grabCursor:!0,loop:i.length>3,centeredSlides:!0,slidesPerView:"auto",coverflowEffect:{rotate:40,stretch:0,depth:100,modifier:1,slideShadows:!1},modules:[x,f,p],spaceBetween:50,navigation:!0,pagination:{clickable:!0},onSlideChange:d,className:l.mySwiper,slidesPerGroup:1,ref:a,children:i.map((e,s)=>n.jsx(S,{className:l.swiperSlide,children:n.jsxs("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",children:[e.media_type==="video"?n.jsx("iframe",{src:e.url,title:e.title,allowFullScreen:!0}):n.jsx("img",{src:e.url,alt:e.title||"Slide Image"}),n.jsx("p",{children:e.title})]})},s))})})}function v({images:i}){const[c,o]=r.useState(0),a=r.useRef(null);r.useEffect(()=>{(()=>{const s=new URLSearchParams(window.location.hash.substring(1)),t=s.get("feed"),h=parseInt(s.get("scene"),10);console.log(`Initial hash params - feed: ${t}, scene: ${h}`),window.history.replaceState(null,null,"#feed=nasa&scene=1"),o(1)})()},[]),r.useEffect(()=>{const e=()=>{const s=new URLSearchParams(window.location.hash.substring(1)),t=parseInt(s.get("scene"),10);!isNaN(t)&&t>0&&t<11&&a.current?a.current.swiper.slideToLoop(t-1):a.current.swiper.slideToLoop(0)};return window.addEventListener("hashchange",e),()=>window.removeEventListener("hashchange",e)},[]);const d=e=>{const s=e.realIndex+1;o(s),window.history.replaceState(null,null,`#feed=nasa&scene=${s}`)};return r.useEffect(()=>{console.log(`activeIndex updated: ${c}`)},[c]),r.useEffect(()=>{u()},[i]),n.jsx("div",{className:l.swiperContainer,children:n.jsx(w,{effect:"slide",grabCursor:!0,loop:i.length>3,centeredSlides:!0,slidesPerView:"auto",modules:[f,p],spaceBetween:0,navigation:!0,pagination:{clickable:!0},onSlideChange:d,className:l.mySwiper,slidesPerGroup:1,ref:a,children:i.map((e,s)=>n.jsx(S,{className:l.swiperSlide,children:n.jsxs("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",children:[e.media_type==="video"?n.jsx("iframe",{src:e.url,title:e.title,allowFullScreen:!0}):n.jsx("img",{src:e.url,alt:e.title||"Slide Image"}),n.jsx("p",{children:e.title})]})},s))})})}function E(){const[i,c]=r.useState(window.innerWidth<800),[o,a]=r.useState([]),[d,e]=r.useState(!1);return r.useEffect(()=>{const s=()=>e(window.parent.document.body.classList.contains("dark"));s();const t=new MutationObserver(s);return t.observe(window.parent.document.body,{attributes:!0,attributeFilter:["class"]}),()=>t.disconnect()},[]),r.useEffect(()=>{const s=()=>c(window.innerWidth<800);return window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)},[]),r.useEffect(()=>{(async()=>{try{const t=await fetch("https://api.nasa.gov/planetary/apod?api_key=DEMO_KEY&hd=True&count=10");if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const h=await t.json();a(h)}catch(t){console.error("Failed to fetch images: "+t)}})()},[]),n.jsx("div",{className:`${d?l.dark:""}`,children:i?n.jsx(v,{images:o}):n.jsx(g,{images:o})})}m(document.getElementById("root")).render(n.jsx(r.StrictMode,{children:n.jsx(E,{})}));

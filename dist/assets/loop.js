import{e as M,r as u,h as q,j as i,S as U,N as z,P as G,b as K,d as Y}from"./index.js";function J(f){let{swiper:e,extendParams:T,on:s,emit:o,params:p}=f;e.autoplay={running:!1,paused:!1,timeLeft:0},T({autoplay:{enabled:!1,delay:3e3,waitForTransition:!0,disableOnInteraction:!1,stopOnLastSlide:!1,reverseDirection:!1,pauseOnMouseEnter:!1}});let y,v,a=p&&p.autoplay?p.autoplay.delay:3e3,r=p&&p.autoplay?p.autoplay.delay:3e3,n,m=new Date().getTime(),I,b,h,j,P,c,D;function _(t){!e||e.destroyed||!e.wrapperEl||t.target===e.wrapperEl&&(e.wrapperEl.removeEventListener("transitionend",_),!(D||t.detail&&t.detail.bySwiperTouchMove)&&w())}const k=()=>{if(e.destroyed||!e.autoplay.running)return;e.autoplay.paused?I=!0:I&&(r=n,I=!1);const t=e.autoplay.paused?n:m+r-new Date().getTime();e.autoplay.timeLeft=t,o("autoplayTimeLeft",t,t/a),v=requestAnimationFrame(()=>{k()})},R=()=>{let t;return e.virtual&&e.params.virtual.enabled?t=e.slides.filter(l=>l.classList.contains("swiper-slide-active"))[0]:t=e.slides[e.activeIndex],t?parseInt(t.getAttribute("data-swiper-autoplay"),10):void 0},L=t=>{if(e.destroyed||!e.autoplay.running)return;cancelAnimationFrame(v),k();let d=typeof t>"u"?e.params.autoplay.delay:t;a=e.params.autoplay.delay,r=e.params.autoplay.delay;const l=R();!Number.isNaN(l)&&l>0&&typeof t>"u"&&(d=l,a=l,r=l),n=d;const E=e.params.speed,A=()=>{!e||e.destroyed||(e.params.autoplay.reverseDirection?!e.isBeginning||e.params.loop||e.params.rewind?(e.slidePrev(E,!0,!0),o("autoplay")):e.params.autoplay.stopOnLastSlide||(e.slideTo(e.slides.length-1,E,!0,!0),o("autoplay")):!e.isEnd||e.params.loop||e.params.rewind?(e.slideNext(E,!0,!0),o("autoplay")):e.params.autoplay.stopOnLastSlide||(e.slideTo(0,E,!0,!0),o("autoplay")),e.params.cssMode&&(m=new Date().getTime(),requestAnimationFrame(()=>{L()})))};return d>0?(clearTimeout(y),y=setTimeout(()=>{A()},d)):requestAnimationFrame(()=>{A()}),d},O=()=>{m=new Date().getTime(),e.autoplay.running=!0,L(),o("autoplayStart")},S=()=>{e.autoplay.running=!1,clearTimeout(y),cancelAnimationFrame(v),o("autoplayStop")},g=(t,d)=>{if(e.destroyed||!e.autoplay.running)return;clearTimeout(y),t||(c=!0);const l=()=>{o("autoplayPause"),e.params.autoplay.waitForTransition?e.wrapperEl.addEventListener("transitionend",_):w()};if(e.autoplay.paused=!0,d){P&&(n=e.params.autoplay.delay),P=!1,l();return}n=(n||e.params.autoplay.delay)-(new Date().getTime()-m),!(e.isEnd&&n<0&&!e.params.loop)&&(n<0&&(n=0),l())},w=()=>{e.isEnd&&n<0&&!e.params.loop||e.destroyed||!e.autoplay.running||(m=new Date().getTime(),c?(c=!1,L(n)):L(),e.autoplay.paused=!1,o("autoplayResume"))},N=()=>{if(e.destroyed||!e.autoplay.running)return;const t=M();t.visibilityState==="hidden"&&(c=!0,g(!0)),t.visibilityState==="visible"&&w()},C=t=>{t.pointerType==="mouse"&&(c=!0,D=!0,!(e.animating||e.autoplay.paused)&&g(!0))},F=t=>{t.pointerType==="mouse"&&(D=!1,e.autoplay.paused&&w())},V=()=>{e.params.autoplay.pauseOnMouseEnter&&(e.el.addEventListener("pointerenter",C),e.el.addEventListener("pointerleave",F))},$=()=>{e.el&&typeof e.el!="string"&&(e.el.removeEventListener("pointerenter",C),e.el.removeEventListener("pointerleave",F))},B=()=>{M().addEventListener("visibilitychange",N)},H=()=>{M().removeEventListener("visibilitychange",N)};s("init",()=>{e.params.autoplay.enabled&&(V(),B(),O())}),s("destroy",()=>{$(),H(),e.autoplay.running&&S()}),s("_freeModeStaticRelease",()=>{(h||c)&&w()}),s("_freeModeNoMomentumRelease",()=>{e.params.autoplay.disableOnInteraction?S():g(!0,!0)}),s("beforeTransitionStart",(t,d,l)=>{e.destroyed||!e.autoplay.running||(l||!e.params.autoplay.disableOnInteraction?g(!0,!0):S())}),s("sliderFirstMove",()=>{if(!(e.destroyed||!e.autoplay.running)){if(e.params.autoplay.disableOnInteraction){S();return}b=!0,h=!1,c=!1,j=setTimeout(()=>{c=!0,h=!0,g(!0)},200)}}),s("touchEnd",()=>{if(!(e.destroyed||!e.autoplay.running||!b)){if(clearTimeout(j),clearTimeout(y),e.params.autoplay.disableOnInteraction){h=!1,b=!1;return}h&&e.params.cssMode&&w(),h=!1,b=!1}}),s("slideChange",()=>{e.destroyed||!e.autoplay.running||(P=!0)}),Object.assign(e.autoplay,{start:O,stop:S,pause:g,resume:w})}const Q="_swiperLoop_hsfuv_5",W="_dark_hsfuv_21",X="_swiperSlide_hsfuv_29",x={swiperLoop:Q,dark:W,swiperSlide:X};function Z({images:f}){const[e,T]=u.useState(1),s=u.useRef(null),[o,p]=u.useState(!1);u.useEffect(()=>{const a=()=>{p(window.parent.document.body.classList.contains("dark"))};a();const r=new MutationObserver(a);return r.observe(window.parent.document.body,{attributes:!0,attributeFilter:["class"]}),()=>r.disconnect()},[]),u.useEffect(()=>{(()=>{const r=new URLSearchParams(window.location.hash.substring(1)),n=r.get("feed"),m=parseInt(r.get("scene"),10);console.log(`Initial hash params - feed: ${n}, scene: ${m}`),window.history.replaceState(null,null,"#feed=nasa&scene=1")})()},[]),u.useEffect(()=>{const a=()=>{const r=new URLSearchParams(window.location.hash.substring(1)),n=parseInt(r.get("scene"),10);!isNaN(n)&&n>0&&n<12&&s.current?s.current.swiper.slideToLoop(n-1):s.current.swiper.slideToLoop(0)};return window.addEventListener("hashchange",a),()=>{window.removeEventListener("hashchange",a)}},[]);const y=a=>{const r=a.realIndex+1;T(r),window.history.replaceState(null,null,`#feed=nasa&scene=${r}`)},v=()=>{window.parent.postMessage({url:window.location.hash,source:"loop"},"*")};return u.useEffect(()=>{console.log(`activeIndex updated: ${e}`)},[e]),u.useEffect(()=>{q()},[f]),i.jsx("div",{className:`${x.swiperLoopContainer}  ${o?x.dark:""}`,children:i.jsx(U,{grabCursor:!0,loop:f.length>3,initialSlide:0,centeredSlides:!1,slidesPerView:8,slidesPerGroup:1,autoplay:{delay:1e4,disableOnInteraction:!1},spaceBetween:10,breakpoints:{1200:{slidesPerView:8},1024:{slidesPerView:7},800:{slidesPerView:6},650:{slidesPerView:5},550:{slidesPerView:4},425:{slidesPerView:3},320:{slidesPerView:2}},modules:[J,z,G],navigation:!0,pagination:{clickable:!0},onSlideChange:y,className:x.swiperLoop,ref:s,children:f.map((a,r)=>i.jsx(K,{className:x.swiperSlide,children:i.jsxs("a",{href:a.url,target:"_blank",rel:"noopener noreferrer",onClick:()=>v(),children:[a.media_type==="video"?i.jsx("iframe",{src:a.url,title:a.title,allowFullScreen:!0}):i.jsx("img",{src:a.url,alt:a.title||"Slide Image"}),i.jsx("p",{children:a.title})]})},r))})})}function ee(){const[f,e]=u.useState([]);return u.useEffect(()=>{(async()=>{try{const s=await fetch("https://api.nasa.gov/planetary/apod?api_key=DEMO_KEY&hd=True&count=11");if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const o=await s.json();e(o)}catch(s){console.error("Failed to fetch images: "+s)}})()},[]),i.jsx("div",{children:i.jsx(Z,{images:f})})}function te(){return i.jsx(i.Fragment,{children:i.jsx(ee,{})})}Y(document.getElementById("root")).render(i.jsx(u.StrictMode,{children:i.jsx(te,{})}));
